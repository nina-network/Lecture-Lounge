{% extends '_layout.html' %}

{% block body %}
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const createPostBtn = document.getElementById("create-post");
            const postBox = document.getElementById("post-box");

            let boxVisible = false;

            createPostBtn.addEventListener("click", function () {
                
                if (!boxVisible) {
                    postBox.style.display = "block";
                    boxVisible = true;
                } else {
                    postBox.style.display = "none";
                    boxVisible = false;
                }
            });
        });
    </script>
    <br>
    <nav id="board" class="shadow navbar navbar-light mx-5">
        <div class="container" id="roomheader">
            <div>
                <h1>{{ room['course_name'] }}</h1>
                
                <div id="description"><p>{{ room['description'] }}</p></div>
            </div>
            <form>
                <button type="button" id="create-post" class="btn">Create Post</button>
                <button type="button" class="btn">Contact TA</button>
                <button type="button" class="btn">Join</button>
            </form>
        </div>
    </nav>
    <div id="post-box" class="container post-box border border-3 p-2 mt-3" style="display: none;">
        <form action="/create-post" method="post">
            <div id="description" class="mb-3 mt-3">
                <label for="post_title" class="form-label">Post Title</label>
                <input type="text" class="form-control" id="post_title" name="post_title" required>
            </div>
            <div id="description" class="mb-3">
                <label for="post_content" class="form-label">Post Content</label>
                <textarea class="form-control" id="post_content" name="post_content" rows="4" required></textarea>
            </div>
            <input type="hidden" name="user_id" value="{{session['user']['user_id']}}">
            <input type="hidden" name="course_id" value="{{room['course_id']}}">
            <button type="submit" class="btn">Submit</button>
        </form>
    </div>
    <br>
    {% for course_id, posts in room_posts.items() %}
        {% if course_id == room['course_id'] %}
            {% for post in posts %}           
    <br>
    <div class="post-box container">
        <nav id="message" class="shadow navbar navbar-light mx-5">
            <div class="container mb-2" id="message">
                <a class="navbar-brand" href="/profile"> 
                    <p id="description">
                        <strong>{{ get_user_by_id(post.user_id)['username'] }}</strong>
                        <br>
                        <strong>{{ post.title }}</strong>
                        <br>
                    </p>
                </a>
            
            </div>
            <div class="container">
                    <p>{{ post.content }}</p>
            </div>
            <div class="container-right">
                <!-- add icons instead of text to button -->
                <button type="button" class="btn btn-transparent">
                    <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-bookmark" viewBox="0 0 16 16">
                        <path d="M4 1a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v14l-6-3-6 3V1z"/>
                    </svg>               
                </button>
                <button type="button" class="btn btn-transparent">
                    <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-chat-left" viewBox="0 0 16 16">
                        <path d="M14 1a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H4.414A2 2 0 0 0 3 11.586l-2 2V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12.793a.5.5 0 0 0 .854.353l2.853-2.853A1 1 0 0 1 4.414 12H14a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"/>
                    </svg>
                </button>
            </div>
        </nav>
    </div>
                
            {% endfor %}
        {% endif %}
    {% endfor %}
    <br>
{% endblock %}